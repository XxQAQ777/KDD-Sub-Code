当你手动停止训练后，在 self.args.log_dir 目录下会生成一个 metrics.npy 文件。你可以新建一个 Python 脚本来读取并画图：

Python

import numpy as np
import matplotlib.pyplot as plt

# 读取数据 (请修改路径为你实际的 log 目录)
data = np.load('./TrafficFlow/log/你的实验目录/metrics.npy', allow_pickle=True).item()

train_loss = data['train_loss']
val_loss = data['val_loss']
epochs = data['epochs']
total_time = data['total_time_min']

print(f"Total Training Time: {total_time:.2f} min")

# 画图
plt.figure(figsize=(10, 6))
plt.plot(epochs, train_loss, label='Train Loss')
plt.plot(epochs, val_loss, label='Valid Loss')
plt.xlabel('Epoch')
plt.ylabel('Loss')
plt.title(f'Training Loss Curve (Total Time: {total_time:.1f} min)')
plt.legend()
plt.grid(True)
plt.show()